## AIレビュー

- 結果: **OK 11 / NG 1** （全12項目）
- NG 箇所: P5 — `code2map/__init__.py` に `__version__` 変数が未定義

| # | 観点 | 結果 | 備考 |
|---|------|------|------|
| C1 | ファイル名の安全性 | OK | 全ファイルを確認、OS禁止文字（`< > : " / \ \| ? *`）を含むファイル名なし |
| C2 | パス結合 | OK | ファイルシステム操作はすべて `pathlib.Path` の `/` 演算子で結合。`parts_generator.py:63` の `f"parts/{filename}"` は MAP.json / INDEX.md 用の論理パス（データ値）であり、実際のファイル書き込み（L89）は `parts_dir / filename`（pathlib）を使用しているため問題なし |
| C3 | ファイル名の大文字小文字 | OK | 大文字小文字のみが異なるファイル名は存在しない |
| C4 | シークレット | OK | APIキー・パスワード・トークン等のハードコードなし。`.env` ファイルのコミットなし。`rules/` 配下のテスト例示用ダミー値（`SecurePass123!` 等）はドキュメント内の教示目的であり実際のクレデンシャルではない |
| C5 | 入力のサニタイズ | OK | CLI の `--lang` はホワイトリスト（`choices=["java", "python"]`）で制御。入力ファイルパスは `Path().exists()` で存在確認。ファイル読み込みは `errors="replace"` でエンコーディングエラーを安全に処理。`--id-prefix` はサニタイズなしだが、生成される ID は出力データ内でのみ使用されファイル名には含まれないため許容範囲 |
| C6 | セットアップ手順 | OK | README の手順（`git clone` → `uv sync --all-extras` → `uv run code2map --help`）で完結する。uv・git・Python 3.9+ が前提だが、Requirements セクションに Python 3.9+、uv のリンクが明記されており、開発者向けツールとして暗黙の前提は許容範囲 |
| C7 | バージョン指定 | OK | README: `Python 3.9+`、pyproject.toml: `requires-python = ">=3.9"` で一致 |
| P1 | 生成ファイル名のサニタイズ | OK | `_build_filename()` で `_UNSAFE_CHARS = re.compile(r'[<>:"/\\|?*]')` により全OS禁止文字を除去。衝突時はハッシュサフィックス（4文字）を自動付与。テスト3件（`test_edge_cases.py:111-176`）で `<init>` → `init` 変換・衝突回避を検証済み |
| P2 | サンプル出力の整合性 | OK | `docs/examples/python/output/parts/`（18ファイル）・`docs/examples/java/output/parts/`（27ファイル）の全ファイル名にOS禁止文字なし |
| P3 | part_file の参照整合性 | OK | Python MAP.json（18エントリ）・Java MAP.json（27エントリ）の全 `part_file` が実在するファイルを指している |
| P4 | INDEX.md のリンク整合性 | OK | Python INDEX.md・Java INDEX.md の全リンク先が実在するファイルを指している |
| P5 | バージョン番号の一致 | NG | `pyproject.toml`: `0.1.2`、`CHANGELOG.md`: `0.1.2` で一致するが、`code2map/__init__.py` に `__version__` 変数が定義されていない |

## 修正対応

| # | 対応内容 | 修正ファイル |
|---|---------|------------|
| P5 | `code2map/__init__.py` に `__version__ = "0.1.2"` を追加 | `code2map/__init__.py` |
